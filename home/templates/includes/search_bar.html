{% load static %}

<style>
.custom-round{border-radius:6px}
.custom-round-lg{border-radius:12px}

.hero-gradient{
  background:linear-gradient(180deg,#1e1b4b 0%,#312e81 100%);
}

@media (min-width:768px){
.stat-divider{
  width:1px;
  height:40px;
  background:rgba(255,255,255,.2)
}
}
</style>

<section class="relative min-h-[60vh] flex items-center justify-center px-4 py-8 overflow-hidden">

    <!-- Background -->
    <div class="absolute inset-0 z-0">
    <img src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?auto=format&fit=crop&w=1600"
        class="w-full h-full object-cover scale-110 opacity-40">
    <div class="absolute inset-0 hero-gradient"></div>
    </div>

    <div class="relative z-10 w-full max-w-xl md:max-w-5xl text-center">

        <p class="text-yellow-400 text-sm md:text-base font-semibold mb-2">
            Homes for rent that fit your timeline
        </p>

        <h1 class="text-white text-3xl md:text-5xl lg:text-6xl font-bold mb-6">
            Discover a place you'll love
        </h1>

        <!-- Card -->
        <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-3xl p-4 md:p-6 shadow-2xl">

            <!-- Toggle -->
            <div class="flex justify-center mb-4">
            <div class="bg-indigo-950/70 p-1 rounded-full flex">

            <button type="button"
            onclick="toggleTab('buy',this)"
            class="tab-btn px-6 py-1.5 rounded-full text-sm font-bold bg-white text-indigo-900 transition-all">
            Buy
            </button>

            <button type="button"
            onclick="toggleTab('rent',this)"
            class="tab-btn px-6 py-1.5 rounded-full text-sm font-bold text-white hover:bg-white/10 transition-all">
            Rent
            </button>

            </div>
            </div>

            <!-- Categories -->
            <div class="flex justify-center gap-4 text-white text-xs md:text-sm mb-4 flex-wrap">

                <button onclick="toggleCategory('fullhouse',this)" class="cat-btn flex items-center gap-1 px-3 py-1 rounded-full border border-white/30 hover:bg-white/10 transition">
                Full House
                </button>

                <button onclick="toggleCategory('flatmates',this)" class="cat-btn flex items-center gap-1 px-3 py-1 rounded-full border border-white/30 hover:bg-white/10 transition">
                Flatmates
                </button>

                <button onclick="toggleCategory('coliving',this)" class="cat-btn flex items-center gap-1 px-3 py-1 rounded-full border border-white/30 hover:bg-white/10 transition">
                Co-Living / PG
                </button>

            </div>


        <form method="GET" action="{% url 'search_projects' %}" class="flex flex-col sm:flex-row bg-white rounded-2xl sm:rounded-full overflow-hidden shadow-lg">

        <input type="hidden" name="type" id="propertyType" value="buy">
        <input type="hidden" name="category" id="propertyCategory" value="fullhouse">

        <input type="text" name="q" placeholder="Search locality, landmark or project" class="flex-1 px-4 py-3 sm:py-3 text-sm focus:outline-none w-full">

        <button class="bg-[#5C51E8] text-white px-6 py-3 sm:py-0 flex items-center justify-center">
          <i class="fas fa-search"></i>
        </button>

        </form>

            
        </div>

        <div class="mt-8 flex justify-between text-white text-center text-xs md:text-sm">

        {% for item in impactmetric %}
        <div>
            <div class="text-yellow-400 text-xl mb-1">
                <i class="{{ item.icon }}"></i>
            </div>
            <div class="font-bold text-lg">{{ item.value }}</div>
            <p class="opacity-80 uppercase tracking-wider text-[10px]">
                {{ item.title }}
            </p>
        </div>
        {% endfor %}

        </div>

    </div>

</section>

<!-- ================= SCRIPT ================= -->

<script>
let currentType = "buy";
let currentCategory = "fullhouse";

function toggleTab(type, btn){

  // if same tab clicked again → UNSELECT
  if(currentType === type){
    currentType = "";
    document.getElementById("propertyType").value = "";

    document.querySelectorAll(".tab-btn").forEach(b=>{
      b.classList.remove("bg-white","text-indigo-900");
      b.classList.add("text-white");
    });

    document.querySelector("input[name='q']").placeholder =
      "Search locality, landmark or project";

    return;
  }

  // normal select
  currentType = type;
  document.getElementById("propertyType").value = type;

  document.querySelectorAll(".tab-btn").forEach(b=>{
    b.classList.remove("bg-white","text-indigo-900");
    b.classList.add("text-white");
  });

  btn.classList.add("bg-white","text-indigo-900");
  btn.classList.remove("text-white");

  const searchInput = document.querySelector("input[name='q']");

  if(type === "rent"){
    searchInput.placeholder = "Search rentals, PG or co-living spaces";
  } else {
    searchInput.placeholder = "Search projects, localities or landmarks";
  }
}

function setCategory(cat){
  currentCategory = cat;
  document.getElementById("propertyCategory").value = cat;
}
function toggleCategory(type, btn){

  const input = document.getElementById("propertyCategory");

  // already selected → unselect
  if(input.value === type){
    input.value = "";

    document.querySelectorAll(".cat-btn").forEach(b=>{
      b.classList.remove("bg-yellow-400","text-black");
    });

    return;
  }

  // new select
  input.value = type;

  document.querySelectorAll(".cat-btn").forEach(b=>{
    b.classList.remove("bg-yellow-400","text-black");
  });

  btn.classList.add("bg-yellow-400","text-black");
}
</script>

