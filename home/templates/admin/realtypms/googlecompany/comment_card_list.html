{% extends "admin/change_list.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}

<style>

    .cards{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(520px,1fr));
    gap:18px;
    margin-top:20px;
}

/* ‚úÖ Card */
.card{
    background:#fff;
    border-radius:14px;
    box-shadow:0 10px 25px rgba(0,0,0,.08);
    padding:14px;
    width:100%;
    overflow:hidden;
    border:1px solid #eef2f7;
}

/* HEADER */
.header{
    display:flex;
    align-items:center;
    gap:10px;
}

/* LOGO / AVATAR */
.logo{
    width:44px;
    height:44px;
    background:#f3f4f6;
    border-radius:10px;
    overflow:hidden;
    flex:0 0 auto;
}
.logo img{
    width:100%;
    height:100%;
    object-fit:cover;
}

.title{
    font-size:16px;
    font-weight:800;
    line-height:1.2;
    color:#0f172a;
}
.small{
    font-size:12px;
    color:#6b7280;
    margin-top:2px;
}

/* TEXT */
.meta{
    font-size:13px;
    color:#555;
    margin-top:5px;
    word-break:break-word;      /* ‚úÖ Address / website cut fix */
    overflow-wrap:anywhere;     /* ‚úÖ long text wrap */
}

/* BADGES */
.badge{
    display:inline-block;
    padding:4px 10px;
    font-size:12px;
    border-radius:20px;
    background:#eef2ff;
    margin:6px 6px 0 0;
    white-space:nowrap;
}
.green{background:#dcfce7;color:#166534}
.red{background:#fee2e2;color:#991b1b}
.blue{background:#dbeafe;color:#1d4ed8}
.yellow{background:#fef9c3;color:#854d0e}
.gray{background:#f3f4f6;color:#111827}

/* Divider */
.hr{
    border:none;
    border-top:1px solid #e5e7eb;
    margin:9px 0;
}

/* ACTIONS */
.actions{
    margin-top:10px;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
}
.actions a{
    padding:9px 14px;
    border-radius:999px;
    font-size:13px;
    font-weight:800;
    display:inline-flex;
    align-items:center;
    gap:7px;
    text-decoration:none;
    white-space:nowrap;
}
.call-btn{background:#0f766e;color:#fff;}
.whatsapp-btn{background:#25D366;color:#fff;}
.edit-btn{border:1px solid #ddd;color:#111;background:#fff;}
.map-btn{background:#111827;color:#fff;}
.actions a i{font-size:15px;}

/* Rating Stars */
.stars{
    display:flex;
    gap:6px;
    align-items:center;
    margin-top:5px;
    flex-wrap:wrap;
}
.star-badge{
    padding:4px 10px;
    border-radius:20px;
    background:#fff7ed;
    color:#9a3412;
    border:1px solid #fed7aa;
    font-size:12px;
    font-weight:800;
}
.review-badge{
    padding:4px 10px;
    border-radius:20px;
    background:#f3f4f6;
    color:#111;
    font-size:12px;
    font-weight:800;
}

/* ‚úÖ MOBILE FIX */
@media (max-width: 640px){
    .cards{
        grid-template-columns:1fr !important;
        gap:14px !important;
        padding:0 6px !important;
    }

    .card{
        width:100% !important;
        padding:14px !important;
        border-radius:16px !important;
    }

    /* ‚úÖ Admin content fit */
    #content{
        padding:10px !important;
    }

    /* ‚úÖ No horizontal scroll */
    #container, .content, .results{
        max-width:100% !important;
        overflow-x:hidden !important;
    }

    /* ‚úÖ buttons full width on mobile */
    .actions a{
        flex:1;
        min-width:120px;
        justify-content:center;
    }
}

</style>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
{% endblock %}

{% block result_list %}
<div class="cards">
{% for obj in cl.result_list %}
<div class="card">

    <div class="header">
        <div class="header">
        <div class="logo" style="display:flex;align-items:center;justify-content:center;">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="default">
    </div>

        <div class="title">
            <span class="badge green">G{{ obj.company.id|stringformat:"03d" }}</span>
            <span class="badge red">CM{{ obj.id|stringformat:"03d" }}</span>
            {{ obj.company.name }}
        </div>
    </div>

    <div class="meta">üìç {{ obj.company.address|default:"‚Äî" }}</div>

    <div>
        <span class="badge">{{ obj.company.category|default:"‚Äî" }}</span>
        <span class="badge">{{ obj.company.status|default:"‚Äî" }}</span>
    </div>

    <hr style="border:none;border-top:1px solid #e5e7eb;margin:7px 0;">

    <div class="meta">
        üí¨ <strong>Comment:</strong><br>
        {{ obj.comment|default:"‚Äî"|linebreaksbr }}
    </div>

    <hr style="border:none;border-top:1px solid #e5e7eb;margin:7px 0;">

    <div class="meta">
        üë§ Created: {{ obj.created_by|default:"‚Äî" }},
        {{ obj.create_at|date:"d M Y, h:i A"|default:"‚Äî" }}<br>
        ‚úèÔ∏è Updated: {{ obj.updated_by|default:"‚Äî" }},
        {{ obj.update_at|date:"d M Y, h:i A"|default:"‚Äî" }}
    </div>

    <div class="actions">
        {% if obj.company.phone %}
        <a class="call-btn" href="tel:{{ obj.company.phone }}">
            <i class="fas fa-phone"></i> {{ obj.company.phone }}
        </a>
        <a class="whatsapp-btn"
           href="https://wa.me/{{ obj.company.phone|cut:'+' }}?text=Hello%20{{ obj.company.name }}"
           target="_blank">
            <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        {% endif %}

        <a class="edit-btn"
            href="{% url 'admin:realtypms_googlecompany_change' obj.id %}?_changelist_filters={{ request.GET.urlencode }}">
                <i class="fas fa-pen"></i>
                Edit
        </a>

    </div>

</div>
{% endfor %}
</div>
{% endblock %}
