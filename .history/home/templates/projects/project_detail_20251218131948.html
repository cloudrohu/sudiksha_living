{% extends "base.html" %}
{% load static %}
{% load humanize %}

{% block title %}{{ project.project_name }}{% endblock %}

{% block content %}

<!-- ================= HEADER ================= -->
<section class="border-b bg-white sticky top-0 z-40">
  <div class="max-w-7xl mx-auto px-4 py-4">

    <nav class="text-sm text-gray-500 mb-2">
      <a href="/">Home</a> /
      <a href="#">{{ project.city }}</a> /
      <span class="text-gray-800 font-medium">{{ project.project_name }}</span>
    </nav>

    <div class="flex flex-col md:flex-row justify-between gap-4">
      <div>
        <h1 class="text-3xl font-bold">{{ project.project_name }}</h1>
        <p class="text-gray-600 mt-1">
          Flats by <strong>{{ project.developer }}</strong>,
          {{ project.locality }}, {{ project.city }}
        </p>

        {% if project.rera.exists %}
        <span class="inline-block mt-2 text-green-600 text-sm font-semibold">
          ✔ RERA Registered
        </span>
        {% endif %}
      </div>

      <div class="text-right">
        <p class="text-sm text-gray-500">Starting Price</p>
        <p class="text-2xl font-bold text-gray-900">
          {{ project.priceing }}
        </p>
      </div>
    </div>
  </div>
</section>

<!-- ================= GALLERY ================= -->
<section class="max-w-7xl mx-auto p-4">
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
    {% for img in gallery %}
      <img src="{{ img.image.url }}"
           class="rounded-lg object-cover cursor-pointer hover:opacity-90">
    {% empty %}
      <p>No gallery images available.</p>
    {% endfor %}
  </div>
</section>

<!-- ================= OVERVIEW ================= -->
<section class="max-w-7xl mx-auto p-4" id="overview">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">Project Overview</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-6">
    <div class="grid md:grid-cols-4 gap-4 text-sm">
      <div><strong>Land Parcel:</strong> {{ project.land_parce }}</div>
      <div><strong>Floors:</strong> {{ project.floor }}</div>
      <div><strong>BHK:</strong> {{ project.bhk_type }}</div>
      <div>
        <strong>Possession:</strong>
        {{ project.possession_month }} {{ project.possession_year }}
      </div>
    </div>

    {% for w in project.welcomes.all %}
      <p class="mt-4 text-gray-700">{{ w.description }}</p>
    {% endfor %}
  </div>
</section>

<!-- ================= PRICING ================= -->
<section class="max-w-7xl mx-auto p-4" id="pricing">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">Pricing & Configuration</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-6 overflow-x-auto">
    <table class="w-full border text-sm">
      <tr class="bg-gray-100">
        <th class="border px-3 py-2">BHK</th>
        <th class="border px-3 py-2">Area (sqft)</th>
        <th class="border px-3 py-2">Price</th>
      </tr>

      {% for c in configurations %}
      <tr class="text-center">
        <td class="border px-3 py-2">{{ c.bhk_type }}</td>
        <td class="border px-3 py-2">{{ c.area_sqft }}</td>
        <td class="border px-3 py-2">
          ₹ {{ c.price_in_rupees|intcomma }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3" class="text-center py-4">No pricing data</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</section>

<!-- ================= AMENITIES ================= -->
<section class="max-w-7xl mx-auto p-4" id="amenities">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">Amenities</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-6 grid grid-cols-2 md:grid-cols-5 gap-4">
    {% for a in amenities %}
      <div class="border rounded-lg p-3 text-center text-sm">
        {{ a.amenities.title }}
      </div>
    {% empty %}
      <p>No amenities added.</p>
    {% endfor %}
  </div>
</section>

<!-- ================= BANK APPROVAL ================= -->
<section class="max-w-7xl mx-auto p-4" id="bank">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">Project Approved By</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-6 flex flex-wrap gap-6">
    {% for b in bank_offers %}
      <img src="{{ b.bank.logo.url }}" class="h-12 object-contain">
    {% endfor %}
  </div>
</section>

<!-- ================= RERA ================= -->
<section class="max-w-7xl mx-auto p-4">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">RERA Information</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-6">
    {% for r in rera_list %}
      <img src="{{ r.qr_image.url }}" class="w-32 mb-2">
      <p class="font-semibold">{{ r.registration_no }}</p>
      <p class="text-sm text-gray-600">{{ r.site_address }}</p>
    {% endfor %}
  </div>
</section>

<!-- ================= FAQ ================= -->
<section class="max-w-7xl mx-auto p-4" id="faqs">
  <div class="bg-[#e8eff5] px-5 py-3 border rounded-t-lg">
    <h2 class="text-xl font-semibold">FAQs</h2>
  </div>

  <div class="bg-white border border-t-0 rounded-b-lg p-4 space-y-3">
    {% for f in why_invest %}
      <div class="border p-4 rounded">
        <p class="font-semibold">{{ f.title }}</p>
        <p class="text-sm text-gray-600 mt-1">{{ f.discripation }}</p>
      </div>
    {% endfor %}
  </div>
</section>

{% endblock %}
